import{ag as h,r as a,A as W,u as Z,h as k,av as ee,y as te,br as _,bs as se,bt as ae,bu as le,bv as re,j as e,bw as oe,bx as ne,f as ie,ax as de,I as K,t as O,S as ce,bk as ue,aw as pe}from"./index-CZbEahd3.js";import{I as me,C as xe,S as y}from"./index-BHE3UMyB.js";import{P as he}from"./index-MowpJULf.js";import{u as ge,T as fe}from"./index-U4nUyWrz.js";import{P as be}from"./index-9an5q22P.js";import{S as L,f as V,g as z,h as B,i as je,j as u}from"./table-B4zowmnD.js";import"./index-DKGNVKDd.js";import"./index-DwZFJwnh.js";import"./index-BPngAgPS.js";import"./input-Be_w8K09.js";import"./index-DJt_5zaH.js";import"./popover-C2UtF6Ak.js";import"./index-CqTivY8G.js";import"./label-B-33YOMQ.js";import"./index-5_djxRHe.js";import"./checkbox-C-sC8C-t.js";import"./form-Dzk1BESV.js";import"./index-v16QPNQT.js";import"./index-Bdof4oVa.js";import"./shortcuts-CGqKnNkU.js";import"./index-CTa-Zuxc.js";import"./index-RXV2nzrx.js";function Me(){const c=h(t=>t.hasApiKey),l=h(t=>t.validApiKey),p=h(t=>t.loadingApiKey),g=h(t=>t.updateValidApiKey),{apiKey:D}=a.useContext(W),f=Z(t=>t.setErrorData),M=k(t=>t.setCurrentFlowId),q=k(t=>t.currentFlowId),[s,m]=a.useState(!0),{id:x}=ee(),[i,G]=a.useState([]),[b,Y]=a.useState(""),[o,C]=a.useState([]),[j,N]=a.useState(0),[v,A]=a.useState(12),[w,E]=a.useState(1),[I,Q]=a.useState("Popular"),[n,S]=a.useState("All"),[U,T]=a.useState(""),[d,F]=a.useState("all"),{isFetching:X,data:$}=ge(),H=te();a.useEffect(()=>{p||(c?l||f({title:_,list:[ae]}):(f({title:_,list:[se]}),m(!1)))},[p,l,c,q]),a.useEffect(()=>{J()},[n,I,w,v,i,d,l,c,D,U,p,x]);function J(){p||(m(!0),le({component_id:x,page:w,limit:v,is_component:n==="All"?null:n!=="Flows",sort:I==="Popular"?"-count(downloads)":"name",tags:i,liked:d==="likedbyme"&&l?!0:null,isPrivate:null,search:b===""?null:b,filterByUser:d==="createdbyme"&&l?!0:null}).then(t=>{var r;!(t!=null&&t.authorized)&&l===!0?(g(!1),F("all")):(t!=null&&t.authorized&&g(!0),m(!1),C((t==null?void 0:t.results)??[]),N((i==null?void 0:i.length)===0?Number((t==null?void 0:t.count)??0):((r=t==null?void 0:t.results)==null?void 0:r.length)??0))}).catch(t=>{var r,R;((r=t.response)==null?void 0:r.status)===403||((R=t.response)==null?void 0:R.status)===401?g(!1):(C([]),N(0),m(!1),f({title:re,list:[t.response.data.detail]}))}))}a.useEffect(()=>{M("")},[]);function P(){E(1),A(12)}return e.jsx(he,{betaIcon:!0,title:oe,description:ne,button:e.jsxs(ie,{"data-testid":"api-key-button-store",disabled:s,className:de(`${l?"":"animate-pulse border-error"}`,s?"cursor-not-allowed":""),variant:"primary",onClick:()=>{H("/settings/general/api")},children:[e.jsx(K,{name:"Key",className:"mr-2 w-4"}),"API Key"]}),children:e.jsxs("div",{className:"flex h-full w-full flex-col justify-between",children:[e.jsxs("div",{className:"flex w-full flex-col gap-4 p-0",children:[e.jsxs("div",{className:"flex items-end gap-4",children:[e.jsx(me,{loading:s,divClasses:"relative h-12 w-[40%]",value:b,onChange:t=>Y(t.target.value),onKeyDown:t=>{t.key==="Enter"&&T(O.uniqueId())},onClick:()=>{T(O.uniqueId())}}),e.jsxs("div",{className:"ml-4 flex w-full gap-2 border-b border-border",children:[e.jsx("button",{"data-testid":"all-button-store",disabled:s,onClick:()=>{S("All")},className:(n==="All"?"border-b-2 border-primary p-3":"border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(s?" cursor-not-allowed":""),children:"All"}),e.jsx("button",{"data-testid":"flows-button-store",disabled:s,onClick:()=>{P(),S("Flows")},className:(n==="Flows"?"border-b-2 border-primary p-3":"border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(s?" cursor-not-allowed":""),children:"Flows"}),e.jsx("button",{"data-testid":"components-button-store",disabled:s,onClick:()=>{P(),S("Components")},className:(n==="Components"?"border-b-2 border-primary p-3":"border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(s?" cursor-not-allowed":""),children:"Components"}),e.jsx(ce,{content:"Coming Soon",children:e.jsx("button",{className:"cursor-not-allowed p-3 text-muted-foreground",children:"Bundles"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(L,{disabled:s,onValueChange:F,value:d,children:[e.jsx(V,{className:"mr-4 w-[160px] flex-shrink-0",children:e.jsx(z,{placeholder:"Filter Values"})}),e.jsx(B,{children:e.jsxs(je,{children:[e.jsx(u,{value:"all",children:"All"}),e.jsx(u,{disabled:!c||!l,value:"createdbyme",children:"Created By Me"}),e.jsx(u,{disabled:!c||!l,value:"likedbyme",children:"Liked By Me"})]})})]}),x===void 0?e.jsx(fe,{tags:$??[],loadingTags:X,disabled:s,selectedTags:i,setSelectedTags:G}):e.jsxs(ue,{variant:"outline",size:"sq",className:"gap-2 bg-beta-foreground text-background hover:bg-beta-foreground",children:[e.jsx(pe,{to:"/store",className:"cursor-pointer",children:e.jsx(K,{name:"X",className:"h-4 w-4"})}),x]},"id")]}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsx("span",{className:"px-0.5 text-sm text-muted-foreground",children:(!s||o.length!==0)&&e.jsxs(e.Fragment,{children:[j," ",j!==1?"results":"result"]})}),e.jsxs(L,{disabled:s,onValueChange:t=>{Q(t)},children:[e.jsx(V,{"data-testid":"select-order-store",children:e.jsx(z,{placeholder:"Popular"})}),e.jsxs(B,{children:[e.jsx(u,{value:"Popular",children:"Popular"}),e.jsx(u,{value:"Alphabetical",children:"Alphabetical"})]})]})]}),e.jsx("div",{className:"grid w-full gap-4 md:grid-cols-2 lg:grid-cols-3",children:!s||o.length!==0?o.map(t=>{var r;return e.jsx(e.Fragment,{children:e.jsx(xe,{data:t,authorized:l,disabled:s,playground:((r=t.last_tested_version)==null?void 0:r.includes("1.0.0"))&&!t.is_component},t.id)})}):e.jsxs(e.Fragment,{children:[e.jsx(y,{}),e.jsx(y,{}),e.jsx(y,{})]})}),!s&&(o==null?void 0:o.length)===0&&e.jsx("div",{className:"mt-6 flex w-full items-center justify-center text-center",children:e.jsx("div",{className:"flex h-full w-full flex-col",children:e.jsx("div",{className:"flex w-full flex-col gap-4",children:e.jsx("div",{className:"grid w-full gap-4",children:d!="all"?e.jsxs(e.Fragment,{children:["You haven't"," ",d==="createdbyme"?"created":"liked"," ","anything with the selected filters yet."]}):e.jsxs(e.Fragment,{children:["There are no"," ",n=="Flows"?"Flows":"Components"," with the selected filters."]})})})})})]}),!s&&o.length>0&&e.jsx("div",{className:"relative py-6",children:e.jsx(be,{storeComponent:!0,pageIndex:w,pageSize:v,totalRowsCount:j,paginate:(t,r)=>{E(r),A(t)}})})]})})}export{Me as default};
