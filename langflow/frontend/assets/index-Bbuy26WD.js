import{r as a,j as e,c as g,C as me,A as ie,B as M,$ as xe,a as U,b as R,d as A,e as O,E as Q,f as Y,g as G,h as ue,n as he,u as Z,i as pe,k as ee,I as D,l as fe,m as je,L as Ne,S as W,o as ge,U as ve,p as Ce,q as z,s as q,t as X,v as se,w as be,x as we,y as Se}from"./index-BMduUo-e.js";import{H as ye}from"./index-B1Vg1Uhv.js";import{P as Te}from"./index-KTGLGf7v.js";import{C as te,a as ae}from"./checkbox-CDPHlcmT.js";import{I as _e}from"./input-0yNO_Rdy.js";import{C as h}from"./index-BuHP5LV3.js";import"./popover-Ig0gGBrk.js";import"./index-CSrcWjzj.js";import"./index-BEAjmx8s.js";import"./label-D0S6d1zR.js";import"./shortcuts-CgY7Vei-.js";import"./select-NgJ71qQw.js";import"./index-B-hPoVZM.js";const re=a.forwardRef(({className:r,...l},c)=>e.jsx("div",{className:"",children:e.jsx("table",{ref:c,className:g("w-full caption-bottom text-sm",r),...l})}));re.displayName="Table";const le=a.forwardRef(({className:r,...l},c)=>e.jsx("thead",{ref:c,className:g("[&_tr]:border-b",r),...l}));le.displayName="TableHeader";const ce=a.forwardRef(({className:r,...l},c)=>e.jsx("tbody",{ref:c,className:g("[&_tr:last-child]:border-0",r),...l}));ce.displayName="TableBody";const Ee=a.forwardRef(({className:r,...l},c)=>e.jsx("tfoot",{ref:c,className:g("bg-primary font-medium text-primary-foreground",r),...l}));Ee.displayName="TableFooter";const J=a.forwardRef(({className:r,...l},c)=>e.jsx("tr",{ref:c,className:g("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...l}));J.displayName="TableRow";const j=a.forwardRef(({className:r,...l},c)=>e.jsx("th",{ref:c,className:g("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...l}));j.displayName="TableHead";const N=a.forwardRef(({className:r,...l},c)=>e.jsx("td",{ref:c,className:g("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...l}));N.displayName="TableCell";const Ue=a.forwardRef(({className:r,...l},c)=>e.jsx("caption",{ref:c,className:g("mt-4 text-sm text-muted-foreground",r),...l}));Ue.displayName="TableCaption";function ne({title:r,titleHeader:l,cancelText:c,confirmationText:I,children:k,icon:P,data:n,index:v,onConfirm:C,asChild:b}){const B=he[P],[w,T]=a.useState(!1),[S,x]=a.useState(!1),[$,u]=a.useState(!1),[p,L]=a.useState((n==null?void 0:n.password)??""),[f,H]=a.useState((n==null?void 0:n.username)??""),[y,F]=a.useState((n==null?void 0:n.password)??""),[_,V]=a.useState((n==null?void 0:n.is_active)??!1),[E,s]=a.useState((n==null?void 0:n.is_superuser)??!1),[t,o]=a.useState(me),{userData:i}=a.useContext(ie);function m({target:{name:d,value:oe}}){o(de=>({...de,[d]:oe}))}a.useEffect(()=>{n?(m({target:{name:"username",value:f}}),m({target:{name:"is_active",value:_}}),m({target:{name:"is_superuser",value:E}})):K()},[$]);function K(){L(""),H(""),F("")}return e.jsxs(M,{size:"medium-h-full",open:$,setOpen:u,children:[e.jsx(M.Trigger,{asChild:b,children:k}),e.jsxs(M.Header,{description:l,children:[e.jsx("span",{className:"pr-2",children:r}),e.jsx(B,{name:"icon",className:"h-6 w-6 pl-1 text-foreground","aria-hidden":"true"})]}),e.jsx(M.Content,{children:e.jsxs(xe,{onSubmit:d=>{if(p!==y){d.preventDefault();return}K(),C(1,t),u(!1),d.preventDefault()},children:[e.jsxs("div",{className:"grid gap-5",children:[e.jsxs(U,{name:"username",children:[e.jsx("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"space-between"},children:e.jsxs(R,{className:"data-[invalid]:label-invalid",children:["Username"," ",e.jsx("span",{className:"font-medium text-destructive",children:"*"})]})}),e.jsx(A,{asChild:!0,children:e.jsx("input",{onChange:({target:{value:d}})=>{m({target:{name:"username",value:d}}),H(d)},value:f,className:"primary-input",required:!0,placeholder:"Username"})}),e.jsx(O,{match:"valueMissing",className:"field-invalid",children:"Please enter your username"})]}),e.jsxs("div",{className:"flex flex-row",children:[e.jsx("div",{className:"mr-3 basis-1/2",children:e.jsxs(U,{name:"password",serverInvalid:p!=y,children:[e.jsx("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"space-between"},children:e.jsxs(R,{className:"data-[invalid]:label-invalid flex",children:["Password"," ",e.jsx("span",{className:"ml-1 mr-1 font-medium text-destructive",children:"*"}),w&&e.jsx(Q,{onClick:()=>T(!w),className:"h-5 cursor-pointer",strokeWidth:1.5}),!w&&e.jsx(Y,{onClick:()=>T(!w),className:"h-5 cursor-pointer",strokeWidth:1.5})]})}),e.jsx(A,{asChild:!0,children:e.jsx("input",{onChange:({target:{value:d}})=>{m({target:{name:"password",value:d}}),L(d)},value:p,className:"primary-input",required:!n,type:w?"text":"password"})}),e.jsx(O,{className:"field-invalid",match:"valueMissing",children:"Please enter a password"}),p!=y&&e.jsx(O,{className:"field-invalid",children:"Passwords do not match"})]})}),e.jsx("div",{className:"basis-1/2",children:e.jsxs(U,{name:"confirmpassword",serverInvalid:p!=y,children:[e.jsx("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"space-between"},children:e.jsxs(R,{className:"data-[invalid]:label-invalid flex",children:["Confirm password"," ",e.jsx("span",{className:"ml-1 mr-1 font-medium text-destructive",children:"*"}),S&&e.jsx(Q,{onClick:()=>x(!S),className:"h-5 cursor-pointer",strokeWidth:1.5}),!S&&e.jsx(Y,{onClick:()=>x(!S),className:"h-5 cursor-pointer",strokeWidth:1.5})]})}),e.jsx(A,{asChild:!0,children:e.jsx("input",{onChange:d=>{F(d.target.value)},value:y,className:"primary-input",required:!n,type:S?"text":"password"})}),e.jsx(O,{className:"field-invalid",match:"valueMissing",children:"Please confirm your password"})]})})]}),e.jsxs("div",{className:"flex gap-8",children:[e.jsx(U,{name:"is_active",children:e.jsxs("div",{children:[e.jsx(R,{className:"data-[invalid]:label-invalid mr-3",children:"Active"}),e.jsx(A,{asChild:!0,children:e.jsx(te,{value:_,checked:_,id:"is_active",className:"relative top-0.5",onCheckedChange:d=>{m({target:{name:"is_active",value:d}}),V(d)}})})]})}),(i==null?void 0:i.is_superuser)&&e.jsx(U,{name:"is_superuser",children:e.jsxs("div",{children:[e.jsx(R,{className:"data-[invalid]:label-invalid mr-3",children:"Superuser"}),e.jsx(A,{asChild:!0,children:e.jsx(te,{checked:E,value:E,id:"is_superuser",className:"relative top-0.5",onCheckedChange:d=>{m({target:{name:"is_superuser",value:d}}),s(d)}})})]})})]})]}),e.jsxs("div",{className:"float-right",children:[e.jsx(G,{variant:"outline",onClick:()=>{u(!1)},className:"mr-3",children:c}),e.jsx(ue,{asChild:!0,children:e.jsx(G,{className:"mt-8",children:I})})]})]})})]})}function Be(){const[r,l]=a.useState(""),[c,I]=a.useState(10),[k,P]=a.useState(1),[n,v]=a.useState(!0),C=Z(s=>s.setSuccessData),b=Z(s=>s.setErrorData),{userData:B}=a.useContext(ie),[w,T]=a.useState(0),S=pe(s=>s.setCurrentFlowId);a.useEffect(()=>{S("")},[]);const x=a.useRef([]);a.useEffect(()=>{setTimeout(()=>{p()},500)},[]);const[$,u]=a.useState(x.current);function p(){v(!0),ee(k-1,c).then(s=>{T(s.total_count),x.current=s.users,u(s.users),v(!1)}).catch(s=>{v(!1)})}function L(s,t){v(!0),I(t),P(s),ee(t*(s-1),t).then(o=>{T(o.total_count),x.current=o.users,u(o.users),v(!1)}).catch(o=>{v(!1)})}function f(){P(1),I(10),p()}function H(s){if(l(s),s==="")u(x.current);else{const t=x.current.filter(o=>o.username.toLowerCase().includes(s.toLowerCase()));u(t)}}function y(s){ge(s.id).then(t=>{f(),C({title:ve})}).catch(t=>{b({title:Ce,list:[t.response.data.detail]})})}function F(s,t){z(s,t).then(o=>{f(),C({title:q})}).catch(o=>{b({title:X,list:[o.response.data.detail]})})}function _(s,t,o){const i=se.cloneDeep(o);i.is_active=!s,z(t,i).then(m=>{f(),C({title:q})}).catch(m=>{b({title:X,list:[m.response.data.detail]})})}function V(s,t,o){const i=se.cloneDeep(o);i.is_superuser=!s,z(t,i).then(m=>{f(),C({title:q})}).catch(m=>{b({title:X,list:[m.response.data.detail]})})}function E(s){be(s).then(t=>{z(t.id,{is_active:s.is_active,is_superuser:s.is_superuser}).then(o=>{f(),C({title:we})})}).catch(t=>{b({title:Se,list:[t.response.data.detail]})})}return e.jsxs(e.Fragment,{children:[e.jsx(ye,{}),B&&e.jsxs("div",{className:"admin-page-panel flex h-full flex-col pb-8",children:[e.jsx("div",{className:"main-page-nav-arrangement",children:e.jsxs("span",{className:"main-page-nav-title",children:[e.jsx(D,{name:"Shield",className:"w-6"}),fe]})}),e.jsx("span",{className:"admin-page-description-text",children:je}),e.jsxs("div",{className:"flex w-full justify-between px-4",children:[e.jsxs("div",{className:"flex w-96 items-center gap-4",children:[e.jsx(_e,{placeholder:"Search Username",value:r,onChange:s=>H(s.target.value)}),r.length>0?e.jsx("div",{className:"cursor-pointer",onClick:()=>{l(""),u(x.current)},children:e.jsx(D,{name:"X",className:"w-6 text-foreground"})}):e.jsx("div",{children:e.jsx(D,{name:"Search",className:"w-6 text-foreground"})})]}),e.jsx("div",{children:e.jsx(ne,{title:"New User",titleHeader:"Add a new user",cancelText:"Cancel",confirmationText:"Save",icon:"UserPlus2",onConfirm:(s,t)=>{E(t)},asChild:!0,children:e.jsx(G,{variant:"primary",children:"New User"})})})]}),n?e.jsx("div",{className:"flex h-full w-full items-center justify-center",children:e.jsx(Ne,{remSize:12})}):x.current.length===0?e.jsx(e.Fragment,{children:e.jsx("div",{className:"m-4 flex items-center justify-between text-sm",children:"No users registered."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"m-4 h-full overflow-x-hidden overflow-y-scroll rounded-md border-2 bg-background custom-scroll"+(n?" border-0":""),children:e.jsxs(re,{className:"table-fixed outline-1",children:[e.jsx(le,{className:n?"hidden":"table-fixed bg-muted outline-1",children:e.jsxs(J,{children:[e.jsx(j,{className:"h-10",children:"Id"}),e.jsx(j,{className:"h-10",children:"Username"}),e.jsx(j,{className:"h-10",children:"Active"}),e.jsx(j,{className:"h-10",children:"Superuser"}),e.jsx(j,{className:"h-10",children:"Created At"}),e.jsx(j,{className:"h-10",children:"Updated At"}),e.jsx(j,{className:"h-10 w-[100px] text-right"})]})}),!n&&e.jsx(ce,{children:$.map((s,t)=>e.jsxs(J,{children:[e.jsx(N,{className:"truncate py-2 font-medium",children:e.jsx(W,{content:s.id,children:e.jsx("span",{className:"cursor-default",children:s.id})})}),e.jsx(N,{className:"truncate py-2",children:e.jsx(W,{content:s.username,children:e.jsx("span",{className:"cursor-default",children:s.username})})}),e.jsx(N,{className:"relative left-1 truncate py-2 text-align-last-left",children:e.jsxs(h,{size:"x-small",title:"Edit",titleHeader:`${s.username}`,modalContentTitle:"Attention!",cancelText:"Cancel",confirmationText:"Confirm",icon:"UserCog2",data:s,index:t,onConfirm:(o,i)=>{_(i.is_active,i.id,i)},children:[e.jsx(h.Content,{children:e.jsx("span",{children:"Are you completely confident about the changes you are making to this user?"})}),e.jsx(h.Trigger,{children:e.jsx("div",{className:"flex w-fit",children:e.jsx(ae,{checked:s.is_active})})})]})}),e.jsx(N,{className:"relative left-1 truncate py-2 text-align-last-left",children:e.jsxs(h,{size:"x-small",title:"Edit",titleHeader:`${s.username}`,modalContentTitle:"Attention!",cancelText:"Cancel",confirmationText:"Confirm",icon:"UserCog2",data:s,index:t,onConfirm:(o,i)=>{V(i.is_superuser,i.id,i)},children:[e.jsx(h.Content,{children:e.jsx("span",{children:"Are you completely confident about the changes you are making to this user?"})}),e.jsx(h.Trigger,{children:e.jsx("div",{className:"flex w-fit",children:e.jsx(ae,{checked:s.is_superuser})})})]})}),e.jsx(N,{className:"truncate py-2",children:new Date(s.create_at).toISOString().split("T")[0]}),e.jsx(N,{className:"truncate py-2",children:new Date(s.updated_at).toISOString().split("T")[0]}),e.jsx(N,{className:"flex w-[100px] py-2 text-right",children:e.jsxs("div",{className:"flex",children:[e.jsx(ne,{title:"Edit",titleHeader:`${s.id}`,cancelText:"Cancel",confirmationText:"Save",icon:"UserPlus2",data:s,index:t,onConfirm:(o,i)=>{F(s.id,i)},children:e.jsx(W,{content:"Edit",side:"top",children:e.jsx(D,{name:"Pencil",className:"h-4 w-4 cursor-pointer"})})}),e.jsxs(h,{size:"x-small",title:"Delete",titleHeader:"Delete User",modalContentTitle:"Attention!",cancelText:"Cancel",confirmationText:"Delete",icon:"UserMinus2",data:s,index:t,onConfirm:(o,i)=>{y(i)},children:[e.jsx(h.Content,{children:e.jsx("span",{children:"Are you sure you want to delete this user? This action cannot be undone."})}),e.jsx(h.Trigger,{children:e.jsx(D,{name:"Trash2",className:"ml-2 h-4 w-4 cursor-pointer"})})]})]})})]},t))})]})}),e.jsx(Te,{pageIndex:k,pageSize:c,totalRowsCount:w,paginate:(s,t)=>{L(t,s)}})]})]})]})}export{Be as default};
